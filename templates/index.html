<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spectrum Labs</title>

  <!-- üîí Prevent dark-mode flicker BEFORE render -->
  <script>
    (function () {
      try {
        const theme = localStorage.getItem("ui-theme") || "light";
        document.documentElement.setAttribute("data-theme", theme);
      } catch (e) {}
    })();
  </script>

  <!-- Base background safety (optional but good) -->
  <style>
    html {
      background: #f4f6f8;
    }
    html[data-theme="dark"] {
      background: #0f1115;
    }
  </style>

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
</head>


<body class="theme-light">
<div id="loader">
  <div class="loader-card">
    <div class="logo">
  <img src="/static/logo-light.png" class="logo-light" alt="Spectrum Labs logo light">
  <img src="/static/logo-dark.png" class="logo-dark" alt="Spectrum Labs logo dark">
</div>
    <div class="loader-bar">
      <div class="loader-fill"></div>
    </div>
  </div>
</div>

<div class="container">

  <!-- TITLE + THEME TOGGLE -->
<div class="title-row">
   <section class="card app-header" id="top">
  <div class="header-left">
    <h1 class="logo">Spectrum Labs</h1>
    <p class="tagline">AI-powered accessible color palette generator</p>
  </div>

  <nav class="header-nav">
    <a href="#" onclick="scrollToSection('upload'); return false;">Generate</a>
  <a href="#" onclick="scrollToSection('about'); return false;">About</a>
  <a href="#" onclick="scrollToSection('faq'); return false;">FAQ</a>
  <a href="#" onclick="scrollToSection('contact'); return false;">Contact</a>
  </nav>
  
    <!-- üåó Dark / Light Toggle (Uiverse) -->
    <label class="switch" aria-label="Toggle dark mode">
      <input
  id="input"
  type="checkbox"
  onchange="toggleTheme()"
/>
      <div class="slider round">
        <div class="sun-moon">
          <svg id="moon-dot-1" class="moon-dot" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
          <svg id="moon-dot-2" class="moon-dot" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
          <svg id="moon-dot-3" class="moon-dot" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>

          <svg id="light-ray-1" class="light-ray" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
          <svg id="light-ray-2" class="light-ray" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
          <svg id="light-ray-3" class="light-ray" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>

          <svg id="cloud-1" class="cloud-dark" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
          <svg id="cloud-2" class="cloud-dark" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
          <svg id="cloud-3" class="cloud-dark" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
          <svg id="cloud-4" class="cloud-light" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
          <svg id="cloud-5" class="cloud-light" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
          <svg id="cloud-6" class="cloud-light" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50"/></svg>
        </div>

        <div class="stars">
          <svg id="star-1" class="star" viewBox="0 0 20 20"><path d="M0 10 C10 10,10 10,0 10 Z"/></svg>
          <svg id="star-2" class="star" viewBox="0 0 20 20"><path d="M0 10 C10 10,10 10,0 10 Z"/></svg>
          <svg id="star-3" class="star" viewBox="0 0 20 20"><path d="M0 10 C10 10,10 10,0 10 Z"/></svg>
          <svg id="star-4" class="star" viewBox="0 0 20 20"><path d="M0 10 C10 10,10 10,0 10 Z"/></svg>
        </div>
      </div>
    </label>
  </div>
</section>
  <p class="subtitle">
    Upload an image to generate an accessible, design-ready color system.
  </p>

  <!-- UPLOAD -->
  <!-- ========== IMAGE UPLOAD (DRAG & DROP) ========== -->
<section id="upload" class="card">
<form method="POST" enctype="multipart/form-data" class="upload-form">

  <div class="upload-header">
    <span>Upload Image</span>
    <button type="button" class="reload-btn" onclick="resetUpload()">Reload</button>
  </div>

  <label for="imageInput" class="dropzone" id="dropzone">
    <input type="file" name="image" id="imageInput" accept="image/*" hidden required>

    <div class="drop-placeholder" id="dropPlaceholder">
      <p><strong>Drag & drop an image here</strong></p>
      <p>or click to browse</p>
    </div>

    <img id="imagePreview" class="image-preview" />
  </label>

  <button type="submit"
        name="action"
        value="generate"
        class="generate-btn">
  Generate Palette
</button>

</form>
</section>
<!-- ================= INFO BLOCK ================= -->
<div id="infoBlock">

  <!-- ABOUT -->
  <section class="card about" id="about" >
    <h2>About</h2>
    

  <p>
    <strong>Spectrum Labs</strong> is an AI-powered color palette generator built
    for designers, creators, and developers.
  </p>

  <p>
    Upload any image and Spectrum Labs intelligently extracts
    balanced, accessible color systems you can instantly use in your projects.
  </p>

  <ul class="about-list">
    <li>Generates harmonious color palettes</li>
    <li>Optimizes contrast for accessibility</li>
    <li>Saves hours of manual color picking</li>
    <li>Exports palettes as PNG or CSS tokens</li>
    <li>Runs locally - your images never leave your browser</li>
  </ul>

  <p>
    Whether you're designing a brand, UI system, or creative artwork ‚Äî
    Spectrum Labs makes color simple.
  </p>
  </section>

  <!-- FAQ -->
  <section class="card faq" id="faq">
  <h2>FAQ</h2>

  <details class="faq-item" open>
    <summary>How are colors generated?</summary>
    <p>We extract dominant colors from your image and balance them for accessibility and visual harmony.</p>
  </details>

  <details class="faq-item">
    <summary>Is my image stored anywhere?</summary>
    <p>No. Everything runs locally in your browser. Your images are never uploaded or saved.</p>
  </details>

  <details class="faq-item">
    <summary>Can I download my palette?</summary>
    <p>Yes you can export palettes as PNG or CSS tokens.</p>
  </details>

  <details class="faq-item">
    <summary>Does Spectrum Labs work offline?</summary>
    <p>Yes. Once the page loads, palette generation runs in your browser engine, no internet required.</p>
  </details>

  <details class="faq-item">
    <summary>Will my colors meet accessibility guidelines?</summary>
    <p>Spectrum Labs helps optimize contrast, but final accessibility depends on how you apply colors. We recommend testing with WCAG tools for UI text.</p>
  </details>

  <details class="faq-item">
    <summary>Can I use Spectrum Labs for commercial projects?</summary>
    <p>Yes you‚Äôre free to use your generated palettes in personal or commercial work.</p>
  </details>

  <details class="faq-item">
    <summary>What image types are supported?</summary>
    <p>PNG, JPG, and WebP files are supported.</p>
  </details>

  <details class="faq-item">
    <summary>Who is Spectrum Labs built for?</summary>
    <p>Designers, developers, creators, and anyone who works with color.</p>
  </details>

</section>

  <!-- CONTACT -->
  <section class="card contact" onsubmit="event.preventDefault(); handleContactForm();" id="contact">
  <h2>Contact</h2>

  <form method="POST" action="/contact" class="contact-form">

    <div class="field">
      <label>Name</label>
      <input type="text" name="name" required>
    </div>

    <div class="field">
      <label>Email</label>
      <input type="email" name="email" required>
    </div>

    <div class="field">
      <label>Message</label>
      <textarea name="message" rows="4" required></textarea>
    </div>

    <button class="generate-btn" type="submit">
      Send Message
    </button>

  </form>
</section>


</div>

  {% if data %}
  <form method="POST">
    


    <!-- PALETTE -->
<section class="card">

  <div class="palette-header" >
    <h2>Extracted Palette</h2>

    <div class="palette-actions">
      <button id="copyPaletteBtn" class="copy-btn">Copy Palette</button>
      <button id="downloadPaletteBtn" class="copy-btn">Download PNG</button>
    </div>
  </div>

  <div class="palette" id="paletteList">
    {% for color in data.palette %}
    <div class="swatch"
         style="background: {{ color }}"
         data-color="{{ color }}"
         onclick="assignColor('{{ color }}')">
      <span>{{ color }}</span>
    </div>
    {% endfor %}
  </div>

</section>


    {% for color in data.palette %}
      <input type="hidden" name="palette[]" value="{{ color }}">
    {% endfor %}

    <!-- COLOR ROLES -->
    <section class="card">
      <h2>Color Roles</h2>
      <p class="subtitle">Click a role, then click a color</p>

      <input type="hidden" id="activeRole" value="text">

      <div class="roles-edit">
        {% for role, current_color in data.roles.items() %}
        <div class="role-card {% if role == 'text' %}active{% endif %}"
             data-role="{{ role }}"
             onclick="selectRole('{{ role }}')">
          <strong>{{ role.capitalize() }}</strong>
          <span class="role-preview" style="background: {{ current_color }}"></span>
          <input type="hidden" name="{{ role }}" value="{{ current_color }}">
        </div>
        {% endfor %}
      </div>
    </section>

    <button type="submit" name="action" value="apply" class="generate-btn">
      Apply Changes
    </button>

    <!-- ================= UI PREVIEW ================= -->
<section id="preview" class="card preview"
  style="
    --bg: {{ data.roles.background }};
    --text: {{ data.roles.text }};
    --primary: {{ data.roles.primary }};
    --accent: {{ data.roles.accent }};
  "
>

  <!-- HEADER ROW -->
  <div class="preview-header">
    <h2>UI Preview</h2>

    <button id="downloadPreviewBtn" class="copy-btn">
      Download Preview
    </button>
  </div>

  <div class="preview-canvas">

    <!-- BUTTONS -->
    <div class="ui-group active"
         data-component="button"
         onclick="selectComponent('button')">
      <h4>Buttons</h4>
      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button class="btn primary">Primary</button>
        <button class="btn ghost">Ghost</button>
      </div>
    </div>

    <!-- TAGS -->
    <div class="ui-group"
         data-component="tag"
         onclick="selectComponent('tag')">
      <h4>Tags</h4>
      <span class="tag">Tag</span>
      <span class="tag accent">Accent</span>
    </div>

    <!-- ALERTS -->
    <div class="ui-group"
         data-component="alert"
         onclick="selectComponent('alert')">
      <h4>Alerts</h4>
      <div class="alert">Primary alert</div>
      <div class="alert accent">Accent alert</div>
    </div>

    <!-- CARD LIST -->
<div class="ui-group"
     data-component="card"
     onclick="selectComponent('card')">
  <h4>Cards</h4>

  <div class="card-list">

    <a class="card-item">
      <img src="https://picsum.photos/600/400?1" crossorigin="anonymous">
      <span class="badge-role">Developer</span>
      <h3>A developer codes software and websites.</h3>
      <div class="arrow">‚Üí</div>
    </a>

    <a class="card-item">
      <img src="https://picsum.photos/600/400?1" crossorigin="anonymous">
      <span class="badge-role accent">Designer</span>
      <h3>A designer is a visual problem solver.</h3>
      <div class="arrow">‚Üí</div>
    </a>

    <a class="card-item">
      <img src="https://picsum.photos/600/400?1" crossorigin="anonymous">

      <span class="badge-role muted">Editor</span>
      <h3>An editor ensures content quality.</h3>
      <div class="arrow">‚Üí</div>
    </a>

  </div>
</div>

    <!-- üìÖ CALENDAR -->
    <div class="ui-group"
         data-component="calendar"
         onclick="selectComponent('calendar')">
      <h4>Calendar</h4>
    
      <div id="calendar" style="margin-top:10px;">
        <div id="calendar_header">
          <span>&lt;</span>
          <h1>June 2025</h1>
          <span>&gt;</span>
        </div>

        <div id="calendar_weekdays">
          <div>Su</div><div>Mo</div><div>Tu</div>
          <div>We</div><div>Th</div><div>Fr</div><div>Sa</div>
        </div>

        <div id="calendar_content">
          <div class="blank"></div>
          <div class="blank"></div>
          <div>1</div><div>2</div><div>3</div>
          <div>4</div><div>5</div><div>6</div>
          <div class="today">7</div>
          <div>8</div><div>9</div><div>10</div>
          <div>11</div><div>12</div><div>13</div>
        </div>
      </div>
    </div>

  </div>
</section>



    <!-- EXPORT -->
    <section class="card" id="export-css">
   <div class="header-row">
    <h2>Export CSS</h2>

    <button id="copyCssBtn" class="copy-btn">
      Copy CSS
    </button>
  </div>
  <textarea id="cssOutput" rows="18" readonly style="width:100%"></textarea>
</section>


  </form>
  {% endif %}
  <div id="infoPlaceholder"></div>
</div>
<div id="toast" class="toast"></div>
<footer class="site-footer">
  ¬© 2025 NRMATA // Systems ‚Äî All Rights Reserved
</footer>


<!-- üîí SAFE TOKEN INJECTION -->
<script>
const TOKENS = {
  bg: "{{ data.roles.background if data else '' }}",
  text: "{{ data.roles.text if data else '' }}",
  primary: "{{ data.roles.primary if data else '' }}",
  accent: "{{ data.roles.accent if data else '' }}"
};
</script>

<script>
/* ================= ROLE + COMPONENT LOGIC ================= */
let activeRole = "text";
let activeComponent = "button";

function selectRole(role) {
  activeRole = role;
  document.querySelectorAll(".role-card").forEach(c =>
    c.classList.remove("active")
  );
  document.querySelector(`[data-role='${role}']`)?.classList.add("active");
}

function assignColor(color) {
  const input = document.querySelector(`input[name='${activeRole}']`);
  if (!input) return;

  input.value = color;

  const preview = document.querySelector(
    `[data-role='${activeRole}'] .role-preview`
  );
  if (preview) preview.style.background = color;
}

function selectComponent(type) {
  activeComponent = type;
  generateCSS();

  const exportSection = document.getElementById("export-css");
  if (exportSection) {
    exportSection.scrollIntoView({ behavior: "smooth" });
    exportSection.classList.add("highlight");
    setTimeout(() => exportSection.classList.remove("highlight"), 900);
  }
}

/* ================= EXPORT CSS ================= */
function generateCSS() {
  let css = `
:root {
  --bg: ${TOKENS.bg};
  --text: ${TOKENS.text};
  --primary: ${TOKENS.primary};
  --accent: ${TOKENS.accent};
}
`;

  const blocks = {
    button: `
.btn {
  padding:10px 14px;
  border-radius:10px;
  border:1px solid var(--primary);
}
.btn.primary {
  background:var(--primary);
  color:var(--bg);
}
`,
    tag: `
.tag {
  padding:6px 10px;
  border-radius:999px;
  border:1px solid var(--primary);
}
.tag.accent {
  border-color:var(--accent);
  color:var(--accent);
}
`,
    alert: `
.alert {
  padding:12px;
  border-radius:10px;
  border:1px solid var(--primary);
}
.alert.accent {
  border-color:var(--accent);
}
`,
    card: `
.card-item {
  background: var(--bg);
  color: var(--text);
  border-radius: 14px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.06);
}
`,
    calendar: `
.day {
  width:36px;
  height:36px;
  border-radius:8px;
  border:1px solid var(--primary);
}
.day.active {
  background:var(--primary);
  color:var(--bg);
}
`
  };

  css += blocks[activeComponent] || "";
  document.getElementById("cssOutput").value = css.trim();
}

document.addEventListener("DOMContentLoaded", generateCSS);
</script>

<script>
/* ================= THEME SYSTEM (Uiverse FIXED) ================= */
const THEME_KEY = "ui-theme";

function applyTheme(theme) {
  const html = document.documentElement;
  const body = document.body;
  const toggle = document.getElementById("input");

  html.setAttribute("data-theme", theme);
  body.classList.remove("theme-light", "theme-dark");
  body.classList.add(`theme-${theme}`);

  if (toggle) toggle.checked = theme === "dark";

  localStorage.setItem(THEME_KEY, theme);
}

(function () {
  const saved = localStorage.getItem(THEME_KEY) || "light";
  document.documentElement.setAttribute("data-theme", saved);

  document.addEventListener("DOMContentLoaded", () => {
    applyTheme(saved);
  });
})();

function toggleTheme() {
  const toggle = document.getElementById("input");
  if (!toggle) return;

  const nextTheme = toggle.checked ? "dark" : "light";
  applyTheme(nextTheme);
}
</script>

<script>
/* ================= DRAG & DROP (PERSISTENT PREVIEW) ================= */
const dropzone = document.getElementById("dropzone");
const input = document.getElementById("imageInput");
const preview = document.getElementById("imagePreview");
const placeholder = document.getElementById("dropPlaceholder");

(function restorePreview() {
  const saved = sessionStorage.getItem("previewImage");
  if (saved && preview) {
    preview.src = saved;
    preview.style.display = "block";
    placeholder.style.display = "none";
  }
})();

["dragenter", "dragover"].forEach(evt => {
  dropzone?.addEventListener(evt, e => {
    e.preventDefault();
    dropzone.classList.add("dragover");
  });
});

["dragleave", "drop"].forEach(evt => {
  dropzone?.addEventListener(evt, e => {
    e.preventDefault();
    dropzone.classList.remove("dragover");
  });
});

dropzone?.addEventListener("drop", e => {
  const file = e.dataTransfer.files[0];
  if (file) handleFile(file);
});

input?.addEventListener("change", () => {
  if (input.files[0]) handleFile(input.files[0]);
});

function handleFile(file) {
  if (!file.type.startsWith("image/")) return;

  const reader = new FileReader();
  reader.onload = e => {
    preview.src = e.target.result;
    preview.style.display = "block";
    placeholder.style.display = "none";

    sessionStorage.setItem("previewImage", e.target.result);
  };
  reader.readAsDataURL(file);

  const dt = new DataTransfer();
  dt.items.add(file);
  input.files = dt.files;
}

function resetUpload() {
  input.value = "";
  preview.src = "";
  preview.style.display = "none";
  placeholder.style.display = "block";
  sessionStorage.removeItem("previewImage");
}
</script>

<script>
/* ================= COPY PALETTE + DOWNLOAD PNG ================= */

let copyTimer = null;

function copyPalette() {
  const btn = document.getElementById("copyPaletteBtn");
  const swatches = document.querySelectorAll("#paletteList .swatch");
  const colors = [...swatches].map(s => s.dataset.color || s.style.background);

  if (!colors.length || !btn) return;

  navigator.clipboard?.writeText(colors.join(", "));

  const original = "Copy Palette";
  btn.textContent = "Copied!";
  btn.disabled = true;
  btn.style.opacity = 0.8;

  clearTimeout(copyTimer);
  copyTimer = setTimeout(() => {
    btn.textContent = original;
    btn.disabled = false;
    btn.style.opacity = 1;
  }, 1400);

  showToast("Palette copied");
}


/* ================= DOWNLOAD PALETTE PNG ================= */

function downloadPalettePNG() {
  const swatches = document.querySelectorAll("#paletteList .swatch");
  if (!swatches.length) return;

  const colors = [...swatches].map(s => s.dataset.color || s.style.background);

  const width = 1000;
  const height = 220;
  const swatchWidth = width / colors.length;

  const canvas = document.createElement("canvas");
  canvas.width = width;
  canvas.height = height;
  const ctx = canvas.getContext("2d");

  const dark = document.documentElement.getAttribute("data-theme") === "dark";

  ctx.fillStyle = dark ? "#0f1115" : "#ffffff";
  ctx.fillRect(0, 0, width, height);

  ctx.fillStyle = dark ? "#ffffff" : "#111111";
  ctx.font = "18px Inter, Arial";
  ctx.textAlign = "left";
  ctx.fillText("Extracted Palette", 24, 36);

  colors.forEach((color, i) => {
    const x = i * swatchWidth;

    ctx.fillStyle = color;
    ctx.fillRect(x, 60, swatchWidth, 110);

    ctx.fillStyle = dark ? "#ffffff" : "#111111";
    ctx.font = "14px Inter, Arial";
    ctx.textAlign = "center";
    ctx.fillText(color, x + swatchWidth / 2, 190);
  });

  const link = document.createElement("a");
  link.download = "palette.png";
  link.href = canvas.toDataURL("image/png");
  link.click();

  showToast("PNG downloaded");
}


/* ================= TOAST ================= */

function showToast(msg) {
  let t = document.getElementById("toast");
  if (!t) {
    t = document.createElement("div");
    t.id = "toast";
    t.className = "toast";
    document.body.appendChild(t);
  }

  t.textContent = msg;
  t.classList.add("show");
  setTimeout(() => t.classList.remove("show"), 1400);
}


/* ================= WIRE BUTTONS ================= */

document.addEventListener("DOMContentLoaded", () => {

  document
    .getElementById("copyPaletteBtn")
    ?.addEventListener("click", copyPalette);

  document
    .getElementById("downloadPaletteBtn")
    ?.addEventListener("click", downloadPalettePNG);

});
</script>
<!-- html2canvas -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const btn = document.getElementById("downloadPreviewBtn");

  btn?.addEventListener("click", async e => {
    e.preventDefault();

    const original = btn.textContent;
    btn.disabled = true;
    btn.textContent = "Generating...";

    // üéØ Find preview
    const preview =
      btn.closest(".card.preview") ||
      document.querySelector(".preview-canvas");

    if (!preview) {
      alert("Preview UI not found");
      btn.disabled = false;
      btn.textContent = original;
      return;
    }

    /* ==========================================
       1Ô∏è‚É£  CLONE PREVIEW (OFF-SCREEN)
    ========================================== */
    const clone = preview.cloneNode(true);
    clone.style.position = "fixed";
    clone.style.left = "-9999px";
    clone.style.top = "0";
    clone.style.pointerEvents = "none";
    clone.style.transform = "scale(1)";
    document.body.appendChild(clone);

    /* ==========================================
       2Ô∏è‚É£  SANITIZE ONLY UNSUPPORTED COLORS
    ========================================== */
    clone.querySelectorAll("*").forEach(el => {
      const cs = getComputedStyle(el);

      for (const prop of [
        "color",
        "backgroundColor",
        "borderColor",
        "outlineColor",
        "boxShadow"
      ]) {
        const val = cs[prop];
        if (val && val.includes("color(")) {
          el.style[prop] = "rgba(0,0,0,0)"; // üî• transparent fallback
        }
      }
    });

    // hide images only in clone
    clone.querySelectorAll("img").forEach(i =>
      i.setAttribute("crossorigin", "anonymous")
    );

    try {
      const canvas = await html2canvas(clone, {
        useCORS: true,
        scale: 2,
        backgroundColor: null
      });

      const link = document.createElement("a");
      link.download = "ui-preview.png";
      link.href = canvas.toDataURL("image/png");
      link.click();

    } catch (err) {
      console.error("Preview PNG error ‚Üí", err);
      alert("Could not capture preview ‚Äî see console");
    }

    /* ==========================================
       3Ô∏è‚É£  CLEAN UP
    ========================================== */
    clone.remove();
    btn.disabled = false;
    btn.textContent = original;
  });

});
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {

  const preview = document.getElementById("preview");

  // Check if Apply was clicked previously
  const applied = sessionStorage.getItem("scrollToPreview");

  if (applied && preview) {

    preview.scrollIntoView({
      behavior: "smooth",
      block: "start"
    });

    // remove the flag
    sessionStorage.removeItem("scrollToPreview");

    // optional highlight
    preview.classList.add("focus-pulse");
    setTimeout(()=>preview.classList.remove("focus-pulse"), 900);
  }

  // store flag when button clicked
  document
    .querySelector("button[name='action'][value='apply']")
    ?.addEventListener("click", () => {
      sessionStorage.setItem("scrollToPreview", "1");
    });

});
</script>
<script>
function copyCSS() {
  const btn = document.getElementById("copyCssBtn");
  const css = document.getElementById("cssOutput")?.value;

  if (!btn || !css) return;

  navigator.clipboard?.writeText(css);

  const original = "Copy CSS";
  btn.textContent = "Copied!";
  btn.disabled = true;
  btn.style.opacity = 0.8;

  setTimeout(() => {
    btn.textContent = original;
    btn.disabled = false;
    btn.style.opacity = 1;
  }, 1400);

  // optional toast (works with your existing one)
  if (typeof showToast === "function") {
    showToast("CSS copied");
  }
}

document.addEventListener("DOMContentLoaded", () => {
  document
    .getElementById("copyCssBtn")
    ?.addEventListener("click", copyCSS);
});
</script>
<script>
function showEngine(){
  const el = document.getElementById("paletteEngine");
  if(!el) return;

  el.style.display = "block";

  // smooth scroll to palette area
  el.scrollIntoView({ behavior: "smooth" });
}
</script>
<script>
function handleContactForm(){
  showToast("Message sent ‚ú®");
}
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {

  const infoBlock = document.getElementById("infoBlock");
  const placeholder = document.getElementById("infoPlaceholder");

  // Detect if palette exists (Flask / Jinja)
  const paletteExists = {{ 'true' if data else 'false' }};

  if (paletteExists) {
    placeholder.appendChild(infoBlock);  // move section DOWN
  }

});
</script>
<script>
function showToast(message, type="success"){
  const toast = document.getElementById("toast");

  toast.textContent = message;
  toast.className = "toast " + type;

  setTimeout(()=> toast.classList.add("show"), 10);

  setTimeout(()=>{
    toast.classList.remove("show");
  }, 2500);
}

async function handleContactForm(){

  const btn = document.querySelector(".contact-form button");
  const form = document.querySelector(".contact-form");

  btn.disabled = true;
  btn.textContent = "Sending...";

  const formData = new FormData(form);

  try {
    const res = await fetch("/contact", {
      method: "POST",
      body: formData
    });

    if(res.ok){
      showToast("Message sent successfully", "success");
      form.reset();
    } else {
      showToast("Failed to send message.", "error");
    }

  } catch(e){
    showToast("Network error ‚Äî try again.", "error");
  }

  btn.disabled = false;
  btn.textContent = "Send Message";
}
</script>
<script>
function scrollToSection(id){
  const el = document.getElementById(id);
  if (!el) return;

  el.scrollIntoView({
    behavior: "smooth",
    block: "start"
  });

  // remove hash from URL
  history.replaceState(null, "", window.location.pathname);
}
</script>
<script>
// Hide loader after page finishes loading
function fadeOutLoader(){
  const loader = document.getElementById("loader");
  if(!loader) return;

  loader.style.opacity = "0";
  setTimeout(()=> loader.remove(), 400);
}

document.addEventListener("DOMContentLoaded", ()=>{

  // Was this navigation triggered by form submit?
  const skip = sessionStorage.getItem("skipLoader");

  const loader = document.getElementById("loader");

  if (skip) {
    // skip loader instantly
    loader.style.display = "none";

    // clear flag so next reload shows loader
    sessionStorage.removeItem("skipLoader");
  }

  else {
    // normal load ‚Äî show loader then fade out
    window.addEventListener("load", fadeOutLoader);
  }

  // Mark form submits so loader won't show
  document.querySelectorAll("form").forEach(form=>{
    form.addEventListener("submit", ()=>{
      sessionStorage.setItem("skipLoader","1");
    });
  });

});
</script>



</body>
</html>
